--1. Customers that have ever have their invoices attempted delivery for more than once, --sort by date when the latest incident happens/*select CustomerName,max(I.ConfirmedDeliveryTime) from sales.Invoices I join Sales.Customers C on I.CustomerID = C.CustomerIDwhere JSON_value(I.ReturnedDeliveryData, '$.Events[1].Comment') is not nullgroup by CustomerName */--2. List of Sales People and total numbers of whose orders --that the delivery date is more than 7 days later than the order date.select P.FullName,COUNT(a.OrderID) from Sales.Invoices I join (select Ol.OrderID,I.ConfirmedDeliveryTime from Sales.OrderLines OL join Sales.Invoices I on OL.OrderID = I.OrderIDgroup by OL.OrderID,ConfirmedDeliveryTime) aon I.OrderID = a.OrderIDjoin Sales.Orders O on O.OrderID = a.OrderIDjoin Application.People P on I.SalespersonPersonID = P.PersonIDwhere day(a.ConfirmedDeliveryTime) > day(O.OrderDate) + 7group by p.FullName--3. Total Numbers of stockitems on sales, of each stockitem group, --for each year existing in the database. [total_number, 2013,2014,2015,2016,2017...]/*select oL.OrderID,count(Quantity)from  Warehouse.StockItemStockGroups SISG join sales.OrderLines OL on OL.StockItemID = SISG.StockItemID join Sales.Orders O on O.OrderID = OL.OrderID where SISG.StockItemID in(select distinct SI.StockItemID from Warehouse.StockGroups SG join Warehouse.StockItemStockGroups SISG on SG.StockGroupID = SG.StockGroupIDjoin Warehouse.StockItems SI on SISG.StockItemID = SI.StockItemID)and O.OrderID in (select distinct orderid from Sales.OrderLines)and SISG.StockGroupID in (select distinct StockGroupID from Warehouse.StockItemStockGroups)--order by OL.OrderID,SISG.StockItemID,sisg.StockGroupIDgroup by OL.OrderID;*/