--1. List of customers (name, city, id) and total quanitity of goods purchased on 2013/06/20 (check history)select C.CustomerID, C.CustomerName, CT.CityName, Sum(ol.Quantity) TotalQuantity from sales.Customers FOR SYSTEM_TIME AS OF '2013/06/20' cjoin sales.Orders O on C.CustomerID = O.CustomerIDjoin sales.OrderLines OL on O.orderid= ol.OrderLineIDjoin Application.Cities CT on C.PostalCityID = CT.CityIDgroup by C.CustomerID,C.CustomerName, CT.CityName;--2. List of stockitems that ever had a raise of retial price (id, name, old retial price, new retail price, --raise date) and the customers bought them the most (id, name). If a stockitem raised price more than once, --only use the most recent one.select COUNT(SIA.StockItemID) , SIA.StockItemName from Warehouse.StockItems_Archive SIAgroup by SIA.StockItemNamehaving COUNT(SIA.StockItemID) >1select COUNT(SIA.StockItemID) , SIA.StockItemID from Warehouse.StockItems_Archive SIAgroup by SIA.StockItemIDhaving COUNT(SIA.StockItemID) >1--3. List of StockItem Manufacturing countries and count of items made in that country.(use stockitems table)SELECT 
 JSON_VALUE(SI.CustomFields, '$.CountryOfManufacture') as CountryOfManufacture,
 count(si.StockItemName)
 from Warehouse.StockItems SI
 group by JSON_VALUE(SI.CustomFields, '$.CountryOfManufacture')
